zcat $1 | awk 'BEGIN{for(n=21;n<256;n++)ord[sprintf("%c",n)]=n-33}{if (NR%4==1) {read=$1} else if (NR%4==2) {seq=$1} else if (NR%4==0) {qual=$1;meanqual=0;minqual=255;maxqual=0;Q5=0;Q10=0;Q15=0;Q20=0;Q25=0;Q30=0;Q40=0;Q50=0;Q60=0;Q70=0;Q80=0;for(n=0;n<length(seq);n++){Qn=ord[substr(qual,n,1)];meanqual=meanqual+exp(-1/10*log(10)*Qn);if (minqual>Qn) {minqual=Qn;idxMin=n};if(maxqual<Qn) {maxqual=Qn; idxMax=n};if(Qn<5) Q5=Q5+1;if(Qn<10) Q10=Q10+1;if(Qn<15) Q15=Q15+1;if(Qn<20) Q20=Q20+1;if(Qn<25) Q25=Q25+1;if(Qn<30) Q30=Q30+1;if(Qn<40) Q40=Q40+1;if(Qn<50) Q50=Q50+1;if(Qn<60) Q60=Q60+1;if(Qn<70) Q70=Q70+1;if(Qn<80) Q80=Q80+1;};meanqual=-10*log(meanqual/(length(seq)))/log(10); Q5=Q5/length(seq);Q10=Q10/length(seq);Q15=Q15/length(seq);Q20=Q20/length(seq);Q25=Q25/length(seq);Q30=Q30/length(seq);Q40=Q40/length(seq);Q50=Q50/length(seq);Q60=Q60/length(seq);Q70=Q70/length(seq);Q80=Q80/length(seq); print "R: "read" L: "length(seq)" avgQ: "meanqual" minQ: "minqual" maxQ: "maxqual" Q5: "Q5" Q10: "Q10" Q15: "Q15" Q20: "Q20" Q25: "Q25" Q30: "Q30" Q40: "Q40" Q50: "Q50" Q60: "Q60" Q70: "Q70" Q80: "Q80}}'

#| sed "s/$RIGHT2/ /" | awk '{print $1}'
